/// Files: kernel/events/core.c
/// Fix: 382c27f4ed28f803b1f1473ac2d8db0afc795a1b
/// Fixes: a723968c0ed36db676478c3d26078f13484fe01c

virtual detect

@err@
identifier event;
position p;
@@

perf_event_validate_size(struct perf_event *event)
{
	...
*	__perf_event_read_size@p(event, event->group_leader->nr_siblings + 1);
*	__perf_event_header_size(event, event->attr.sample_type & ~PERF_SAMPLE_READ);
*	perf_event__id_header_size(event);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-6931')
