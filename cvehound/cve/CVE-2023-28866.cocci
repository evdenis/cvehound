/// Files: net/bluetooth/hci_sync.c
/// Fix: bce56405201111807cc8e4f47c6de3e10b17c1ac
/// Fixes: d0b137062b2de75b264b84143d21c98abc5f5ad2

virtual detect

@fix_amd_init1@
symbol amp_init1;
@@

struct hci_init_stage amp_init1[] = {
	...,
*	{}
};

@fix_amd_init2@
symbol amp_init2;
@@

struct hci_init_stage amp_init2[] = {
	...,
*	{}
};

@err_amd_init1 depends on !fix_amd_init1@
symbol amp_init1;
position p;
@@

struct hci_init_stage amp_init1[] =@p {
*	...
};

@err_amd_init2 depends on !fix_amd_init2@
symbol amp_init2;
position p;
@@

struct hci_init_stage amp_init2[] =@p {
*	...
};

@script:python depends on detect@
p << err_amd_init1.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-28866')

@script:python depends on detect@
p << err_amd_init2.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-28866')
