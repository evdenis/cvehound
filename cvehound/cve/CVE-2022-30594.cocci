/// Files: kernel/ptrace.c
/// Fix: ee1fee900537b5d9560e9f937402de5ddc8412f3
/// Fixes: 13c4a90119d28cfcb6b5bdd820c233b86c2b0237

virtual detect

@err@
position p;
identifier flags, data;
@@

ptrace_setoptions(...)
{
	unsigned flags;
	...
*	if (unlikely(data & PTRACE_O_SUSPEND_SECCOMP))@p {
		...
	}
	...
}	

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-30594')
