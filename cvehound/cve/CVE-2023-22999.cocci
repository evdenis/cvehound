/// Files: drivers/usb/dwc3/dwc3-qcom.c
/// Fix: b52fe2dbb3e655eb1483000adfab68a219549e13
/// Fixes: c25c210f590e7a37eecd865d84f97d1f40e39786

virtual detect

@err@
identifier pdev, dev, qcom;
statement S;
position p;
@@

dwc3_qcom_probe(struct platform_device *pdev)
{
	...
*	qcom->urs_usb =@p dwc3_qcom_create_urs_usb_platdev(dev);
*	if (!qcom->urs_usb)
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-22999')
