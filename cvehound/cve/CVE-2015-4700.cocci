/// Files: arch/x86/net/bpf_jit_comp.c
/// Fix: 3f7352bf21f8fd7ba3e2fcef9488756f188e12be
/// Fixes: 0a14842f5a3c0e88a1e59fac5c3025db39721f74

virtual detect

@x86@
@@

#define X86_JB  0x72

@err depends on x86 exists@
symbol pass;
statement S;
position p;
@@

\(bpf_int_jit_compile\|bpf_jit_compile\)(...)
{
	...
*	for (pass = 0; pass <@p 10; pass++) S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2015-4700')
