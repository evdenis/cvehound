/// Files: net/rds/message.c
/// Fix: f753a68980cf4b59a80fe677619da2b1804f526d
/// Fixes: 9426bbc6de99b8649d897b94e8f5916b58195643

virtual detect

@err@
identifier info;
statement S;
position p;
@@

rds_rm_zerocopy_callback(...)
{
	...
*	info = list_entry@p(..., struct rds_msg_zcopy_info, ...);
*	if (info && rds_zcookie_add(info, cookie))
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-1078')
