/// Files: drivers/nvme/target/tcp.c
/// Fix: d920abd1e7c4884f9ecd0749d1921b7ab19ddfbd
/// Detect-To: 872d26a391da92ed8f0c0f5cb5fef428067b7f30

virtual detect

@err@
identifier free_crypto, queue, ret;
position p;
@@

nvmet_tcp_handle_icreq(struct nvmet_tcp_queue *queue)
{
	...
free_crypto:
*	if (queue->hdr_digest || queue->data_digest)
*	nvmet_tcp_free_crypto@p(queue);
*	return ret;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-5178')
