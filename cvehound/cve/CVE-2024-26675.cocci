/// Files: drivers/net/ppp/ppp_async.c drivers/net/ppp_async.c
/// Fix: cb88cb53badb8aeb3955ad6ce80b07b598e310b8
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier chan, cmd, arg;
position p;
@@

ppp_async_ioctl(struct ppp_channel *chan, unsigned int cmd, unsigned long arg)
{
	...
	switch (cmd) {
	case PPPIOCSMRU:
*		if (get_user(val, ...))
*			break;
		... when != if (val > U16_MAX) { err = -EINVAL; break; }
		if (val < PPP_MRU)
			val = PPP_MRU;
*		ap->mru =@p val;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26675')
