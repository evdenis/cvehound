/// Files: sound/soc/codecs/rt5645.c
/// Fix: 6ef5d5b92f7117b324efaac72b3db27ae8bb3082
/// Fixes: cdba4301adda7c60a2064bf808e48fccd352aaa9

virtual detect

@err@
identifier rt5645;
position p;
@@

rt5645_jack_detect_work(...)
{
	...
*	mutex_lock(&rt5645->jd_mutex);
	switch (rt5645->pdata.jd_mode) {
	case 0:
		... when != mutex_unlock(&rt5645->jd_mutex);
*		return;@p
		...
	}
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26722')
