/// Files: sound/soc/qcom/lpass-cdc-dma.c
/// Fix: 1382d8b55129875b2e07c4d2a7ebc790183769ee
/// Fixes: b81af585ea54ee9f749391e594ee9cbd44061eae

virtual detect

@fix@
identifier dmactl;
@@

lpass_cdc_dma_daiops_trigger(...)
{
	...
*	struct lpaif_dmactl *dmactl = NULL;
	...
}

@err depends on !fix@
identifier dmactl;
position p;
@@

lpass_cdc_dma_daiops_trigger(...)
{
	...
*	struct lpaif_dmactl *dmactl;@p
	...
*	__lpass_get_dmactl_handle(..., &dmactl, ...);
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26799')
