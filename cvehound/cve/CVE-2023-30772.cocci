/// Files: drivers/power/supply/da9150-charger.c
/// Fix: 06615d11cc78162dfd5116efb71f29eb29502d37
/// Fixes: c1a281e34dae41379af86b95592a5ae8e9e3af67

virtual detect

@err@
identifier charger;
position p;
@@

da9150_charger_remove(...)
{
	... when != cancel_work_sync(&charger->otg_work);
*	power_supply_unregister@p(\(&charger->battery\|charger->battery\));
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-30772')
