/// Files: drivers/net/ethernet/xircom/xirc2ps_cs.c drivers/net/pcmcia/xirc2ps_cs.c 
/// Fix: e8d20c3ded59a092532513c9bd030d1ea66f5f44
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier local, dev;
position p;
@@

xirc2ps_detach(...)
{
	... when != cancel_work_sync(&local->tx_timeout_task);
*	unregister_netdev@p(dev);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-1670')
