/// Files: drivers/mtd/ubi/build.c
/// Fix: 017c73a34a661a861712f7cc1393a123e5b2208c
/// Fixes: 801c135ce73d5df1caf3eca35b66a10824ae0707

virtual detect

@err@
identifier mtd;
position p;
@@

\(ubi_attach_mtd_dev\|attach_mtd_dev\)(...)
{
	... when != if (!mtd->erasesize) { ... return -EINVAL; }
*	kzalloc@p(...)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-31085')
