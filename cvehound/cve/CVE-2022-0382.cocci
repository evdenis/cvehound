/// Files: net/tipc/socket.c
/// Fix: d6d86830705f173fca6087a3e67ceaf68db80523
/// Detect-To: 908148bc5046e3503f2758d1d94c43766958d5be 

virtual detect

@fix@
identifier skaddr;
@@

__tipc_sendmsg(...)
{
	...
*	struct tipc_socket_addr skaddr;
	...
*	memset(&skaddr, 0, sizeof(skaddr));
	...
}


@err depends on !fix@
identifier skaddr;
position p;
@@

__tipc_sendmsg(...)
{
	...
*	struct tipc_socket_addr skaddr;@p
	... when any
*	skaddr
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-0382')
