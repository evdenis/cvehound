/// Files: drivers/staging/media/sunxi/cedrus/cedrus.c drivers/staging/media/sunxi/cedrus/cedrus.h
/// Fix: 50d0a7aea4809cef87979d4669911276aa23b71f
/// Fixes: 7c38a551bda1b7adea7e98e5c6786f5bee7100b8

virtual detect

@watchdog@
symbol watchdog_work; 
@@

struct cedrus_dev {
	...
*	struct delayed_work watchdog_work;
	...
};

@err depends on watchdog@
identifier dev, pdev;
position p;
@@

cedrus_remove(struct platform_device *pdev)
{
*	struct cedrus_dev *dev = platform_get_drvdata(pdev);
	... when != cancel_delayed_work_sync(&dev->watchdog_work);
*	media_devnode_is_registered@p(dev->mdev.devnode)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-35826')
