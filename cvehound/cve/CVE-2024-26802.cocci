/// Files: drivers/net/ethernet/stmicro/stmmac/stmmac_main.c
/// Fix: 17ccd9798fe0beda3db212cfa3ebe373f605cbd6
/// Fixes: 5a5586112b929546e16029261a987c9197bfdfa2

virtual detect

@err@
identifier priv;
position p;
@@

stmmac_fpe_stop_wq(struct stmmac_priv *priv)
{
	...
	set_bit(__FPE_REMOVING, &priv->fpe_task_state);

*	if (priv->fpe_wq@p)
*		destroy_workqueue(priv->fpe_wq);

	netdev_info(priv->dev, "FPE workqueue stop");
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26802')
