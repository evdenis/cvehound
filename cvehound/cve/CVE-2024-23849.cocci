/// Files: net/rds/af_rds.c
/// Fix: 13e788deb7348cc88df34bed736c3b3b9927ea52
/// Fixes: 3289025aedc018f8fd9d0e37fb9efa0c6d531ffa

virtual detect

@err@
identifier trace, rs;
position p;
@@

rds_recv_track_latency(...)
{
	...
*	if (trace.rx_trace_pos[i] >@p RDS_MSG_RX_DGRAM_TRACE_MAX) {
		rs->rs_rx_traces = 0;
 		return -EFAULT;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-23849')
