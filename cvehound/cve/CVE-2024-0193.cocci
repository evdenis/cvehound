/// Files: net/netfilter/nf_tables_api.c
/// Fix: 7315dc1e122c85ffdfc8defffbb8f8b616c2eb1a
/// Detect-To: 212ed75dc5fb9d1423b3942c8f872a868cda3466

virtual detect

@err@
identifier set, set_update_list;
iterator name list_for_each_entry_safe;
position p;
@@

nft_set_commit_update(struct list_head *set_update_list)
{
	...
	list_for_each_entry_safe(set, ..., set_update_list, ...) {
		...
*		if (!set->ops->commit@p)
*			continue;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-0193')
