/// Files: net/netfilter/nft_set_pipapo.c
/// Fix: 317eb9685095678f2c9f5a8189de698c5354316a
/// Fixes: 3c4287f62044a90e73a561aa05fc46e62da173da

virtual detect

@fix@
identifier net;
@@

nft_pipapo_activate(struct net *net, ...)
{
	...
*	nft_clear(net, &e->ext);
}

@err depends on !fix@
identifier e, f, iter, cont;
position p;
@@

nft_pipapo_walk(...)
{
	...
*	e =@p f->mt[r].e;
	... when != if (!nft_set_elem_active(&e->ext, iter->genmask)) goto cont;
*	iter->err = iter->fn(...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-6817')
