/// Files: arch/arm64/kernel/efi.c drivers/acpi/prmt.c
/// Fix: ff7a167961d1b97e0e205f245f806e564d3505e7
/// Fixes: cefc7ca46235f01d5233e3abd4b79452af01d9e9
/// Version: 1.0.9

virtual detect

@efi_call@
@@

acpi_platformrt_space_handler(...)
{
	...
*	efi_call_virt_pointer(...)
	...
}

@rt_stack_top@
symbol efi_rt_stack_top;
typedef u64;
@@

* u64 *efi_rt_stack_top;

@err depends on efi_call && !rt_stack_top@
position p;
@@

efi_set_mapping_permissions@p(...)
{
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-21102')
