/// Files: drivers/bluetooth/btsdio.c
/// Fix: 1e9ac114c4428fdb7ff4635b45d4f46017e8916f
/// Fixes: ddbaf13e3609442b64abb931ac21527772d87980

virtual detect

@err@
identifier func, data;
position p;
@@

btsdio_remove(struct sdio_func *func)
{
	struct btsdio_data *data = sdio_get_drvdata(func);
	... when != cancel_work_sync(&data->work);
*	data->hdev@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-1989')
