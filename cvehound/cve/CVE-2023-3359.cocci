/// Files: drivers/nvmem/brcm_nvram.c
/// Fix: b0576ade3aaf24b376ea1a4406ae138e2a22b0c0
/// Fixes: 6e977eaa8280e957b87904b536661550f2a6b3e8

virtual detect

@err@
identifier len, data;
position p;
@@

brcm_nvram_parse(...)
{
	...
(
*	data = kzalloc(len, GFP_KERNEL);
|
*	data = kcalloc(1, len, GFP_KERNEL);
)
	... when != if (!data) return -ENOMEM;
*	memcpy_fromio@p(data, ..., len);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-3359')
