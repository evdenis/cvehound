/// Files: mm/memory-tiers.c
/// Fix: 4a625ceee8a0ab0273534cb6b432ce6b331db5ee
/// Fixes: 7b88bda3761b95856cf97822efe8281c8100067b

virtual detect

@err@
identifier default_dram_type;
position p;
@@

memory_tier_init(void)
{
	...
*	default_dram_type = alloc_memory_type(MEMTIER_ADISTANCE_DRAM);
*	if (!default_dram_type@p)
*		panic(...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-23005')
