/// Files: drivers/video/fbdev/pxa3xx-gcu.c drivers/video/pxa3xx-gcu.c
/// Fix: a09d2d00af53b43c6f11e6ab3cb58443c2cac8a7
/// Detect-To: 364dbdf3b6c31a4a5fb7a6d479e7aafb4a7a10b6

virtual detect

@err@
identifier count, size;
position p;
@@

\(pxa3xx_gcu_write\|pxa3xx_gcu_misc_write\)(..., size_t count, ...)
{
	...
*	int@p size = count / 4;
	...
*	ret = copy_from_user(..., words * 4);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-39842')
