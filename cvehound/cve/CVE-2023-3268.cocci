/// Files: kernel/relay.c
/// Fix: 43ec16f1450f4936025a9bdf1a273affdb9732c1
/// Fixes: 8d62fdebdaf9b866c7e236a8f5cfe90e6dba5773

virtual detect

@err@
identifier buf, read_pos, consumed, subbuf_size;
position p;
@@

relay_file_read_start_pos(...)
{
	...
(
*	size_t read_pos =@p consumed * subbuf_size + buf->bytes_consumed;
|
*	read_pos =@p consumed * subbuf_size + buf->bytes_consumed;
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-3268')
