/// Files: net/ipv6/seg6.c
/// Fix: 84a53580c5d2138c7361c7c3eea5b31827e63b35
/// Fixes: 4f4853dc1c9c1994f6f756eabdcc25374ff271d9

virtual detect

@err@
identifier info, hinfo, err, slen, out_unlock;
statement S;
position p;
@@

seg6_genl_sethmac(..., struct genl_info *info)
{
	...
*	if (!info->attrs[SEG6_ATTR_SECRET])
		S
	... when != if (slen > nla_len(info->attrs[SEG6_ATTR_SECRET])) { err = -EINVAL; goto out_unlock; }
*	if (hinfo@p) {
		err = seg6_hmac_info_del(...);
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-2860')
