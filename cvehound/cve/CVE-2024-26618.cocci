/// Files: arch/arm64/kernel/fpsimd.c
/// Fix: dc7eb8755797ed41a0d1b5c0c39df3c8f401b3d9
/// Fixes: 5d0a8d2fba50e9c07cde4aad7fba28c008b07a5b

virtual detect

@err@
identifier task, flush;
position p;
typedef bool;
@@

void sme_alloc(struct task_struct *task, bool flush)
{
*	if (task->thread.sme_state &&@p flush) {
		memset(task->thread.sme_state, 0, sme_state_size(task));
		return;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26618')
