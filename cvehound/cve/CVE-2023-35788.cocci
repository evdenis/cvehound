/// Files: net/sched/cls_flower.c
/// Fix: 4d56304e5827c8cc8cc18c75343d283af7c4825c
/// Fixes: 0a6e77784f490912d81b92cfd48424541c04691e

virtual detect

@err@
identifier key, option_len;
position p;
@@

fl_set_geneve_opt(..., struct fl_flow_key *key, ..., int option_len, ...)
{
	... when != if (key->enc_opts.len > FLOW_DIS_TUN_OPTS_MAX - 4) return ...;
*	memset@p(opt, 0xff, option_len);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-35788')
