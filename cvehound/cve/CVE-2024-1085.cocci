/// Files: net/netfilter/nf_tables_api.c
/// Fix: b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7
/// Fixes: aaa31047a6d25da0fa101da1ed544e1247949b40

virtual detect

@err@
iterator name list_for_each_entry;
position p;
@@

nft_setelem_catchall_deactivate(const struct net *net,
				struct nft_set *set,
				struct nft_set_elem *elem)
{
	...
	list_for_each_entry(...) {
		...
*		if (!nft_is_active@p(net, ext) || ...)
			continue;

		kfree(elem->priv);
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-1085')
