/// Files: net/ipv4/af_inet.c
/// Fix: eef00a82c568944f113f2de738156ac591bbd5cd
/// Fixes: f4713a3dfad045d46afcb9c2a7d0bba288920ed4

virtual detect

@err@
identifier sk;
statement S1, S2;
position p;
@@

inet_recv_error(struct sock *sk, ...)
{
	...
*	if (sk->sk_family == AF_INET)
		S1
	...
*	if (sk->sk_family@p == AF_INET6)
		S2
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26679')
