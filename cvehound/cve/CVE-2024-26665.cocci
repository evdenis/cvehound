/// Files: net/ipv4/ip_tunnel_core.c
/// Fix: d75abeec401f8c86b470e7028a13fcdc87e5dd06
/// Fixes: 4cb47a8644cc9eb8ec81190a50e79e6530d0297f

virtual detect

@err@
identifier icmp6h, len, csum;
position p;
@@

iptunnel_pmtud_build_icmpv6(...)
{
	...
*	csum = csum_partial@p(icmp6h, len, 0);
*	icmp6h->icmp6_cksum = csum_ipv6_magic(...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26665')
