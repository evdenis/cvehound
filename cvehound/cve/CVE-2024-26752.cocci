/// Files: net/l2tp/l2tp_ip6.c
/// Fix: 359e54a93ab43d32ee1bff3c2f9f10cb9f6b6e79
/// Fixes: 9d4c75800f61e5d75c1659ba201b6c0c7ead3070

virtual detect

@err@
identifier sk, len, transhdrlen;
position p;
@@

l2tp_ip6_sendmsg(struct sock *sk, ..., size_t len)
{
	...
	lock_sock(sk);
*	ulen =@p len + skb_queue_empty(&sk->sk_write_queue) ? transhdrlen : 0;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26752')
