/// Files: drivers/tty/vt/vc_screen.c
/// Fix: 0c9acb1af77a3cb8707e43f45b72c95266903cee
/// Fixes: d21b0be246bf3bbf569e6e239f56abb529c7154e

virtual detect

@unicode@
expression E;
@@

#define use_unicode(...) E

@err depends on unicode@
identifier file, inode;
position p;
@@

vcs_write(struct file *file, ...)
{
*	struct inode *inode = file_inode(file);
	... when != if (use_unicode(inode)) return -EOPNOTSUPP;
*	console_lock@p();
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2019-19252')
