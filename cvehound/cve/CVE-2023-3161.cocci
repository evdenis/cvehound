/// Files: drivers/video/fbdev/core/fbcon.c drivers/video/console/fbcon.c
/// Fix: 2b09d5d364986f724f17001ccfe4126b9b43a0be
/// Fixes: 2d2699d984924890f6dac8cf51c3b6311f56816c

virtual detect

@err@
identifier font, info;
position p;
@@

fbcon_set_font(..., struct console_font *font, ...)
{
	... when != if (font->width > 32 || font->height > 32) return -EINVAL;
*	if (!(info->pixmap.blit_x & ...) || ...)
*		return -EINVAL;@p
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-3161')
