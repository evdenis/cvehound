/// Files: drivers/soc/qcom/qcom_aoss.c
/// Fix: 4b41a9d0fe3db5f91078a380f62f0572c3ecf2dd
/// Fixes: 8c75d585b931ac874fbe4ee5a8f1811d20c2817f
/// Version: 1.1.0

virtual detect

@err@
identifier dev, qmp;
position p;
@@

qmp_get(struct device *dev)
{
	...
	return qmp@p ? qmp : ERR_PTR(-EPROBE_DEFER);
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-22996')
