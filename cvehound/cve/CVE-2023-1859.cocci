/// Files: net/9p/trans_xen.c
/// Fix: ea4f1009408efb4989a0f139b70fb338e7f687d0
/// Fixes: 71ebd71921e451f0f942ddfe85d01e31ddc6eb88

virtual detect

@err@
identifier priv, i;
position p;
@@

xen_9pfs_front_free(struct xen_9pfs_front_priv *priv)
{
	...
	for (i = 0; i < priv->num_rings; i++) {
		... when != cancel_work_sync(&ring->work);
*		if (!priv->rings[i].intf@p)
*			break;
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-1859')
