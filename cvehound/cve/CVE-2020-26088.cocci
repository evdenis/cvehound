/// Files: net/nfc/rawsock.c
/// Fix: 26896f01467a28651f7a536143fe5ac8449d4041
/// Fixes: 57be1f3f3ec1ccab6432615ca161c4c9ece2a2aa

virtual detect

@err exists@
identifier sock;
position p;
@@

rawsock_create(...)
{
	... when != if (!\(ns_capable\|capable\)(..., CAP_NET_RAW)) return -EPERM;
*	sock->ops =@p &rawsock_raw_ops;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-26088")
