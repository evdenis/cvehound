/// Files: net/sctp/socket.c
/// Fix: 6feb37b3b06e9049e20dcf7e23998f92c9c5be9a
/// Fixes: 34e5b01186858b36c4d7c87e1a025071e8e2401f

virtual detect

@err@
identifier sp, net;
position p;
@@

sctp_auto_asconf_init(struct sctp_sock *sp)
{
	...
*	spin_lock@p(&net->sctp.addr_wq_lock);
*	list_add_tail(&sp->auto_asconf_list, &net->sctp.auto_asconf_splist);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-0639')
