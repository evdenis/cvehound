/// Files: drivers/hid/hid-core.c
/// Fix: b12fece4c64857e5fab4290bf01b2e0317a88456
/// Fixes: 1b15d2e5b8077670b1e6a33250a0d9577efff4a5

virtual detect

@err@
identifier hid, report, type, id;
position p;
statement S;
@@

hid_validate_values(struct hid_device *hid, ..., unsigned int id, ...)
{
	...
	if (id == 0) {
*		report = list_entry@p(hid->report_enum[type].report_list.next,
				      struct hid_report, list);
	} else S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-1073')
