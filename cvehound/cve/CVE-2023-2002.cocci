/// Files: net/bluetooth/hci_sock.c
/// Fix: 25c150ac103a4ebeed0319994c742a90634ddf18
/// Fixes: f81f5b2db8692ff1d2d5f4db1fde58e67aa976a3

virtual detect

@err@
identifier sk, sock, cmd;
position p;
@@

hci_sock_ioctl(struct socket *sock, unsigned int cmd, ...)
{
	...
*	if (capable@p(CAP_NET_ADMIN))
*		hci_sock_set_flag(sk, HCI_SOCK_TRUSTED);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-2002')
