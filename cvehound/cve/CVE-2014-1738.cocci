/// Files: drivers/block/floppy.c
/// Fix: 2145e15e0557a01b9195d1c7199a1b92cb9be81f
/// Detect-To: v2.6.12-rc2

virtual detect

@err exists@
identifier param, ptr;
type T;
position p;
@@

// FIXME: coccinelle error
//raw_cmd_copyout(..., void *param, struct floppy_raw_cmd *ptr)
raw_cmd_copyout(...)
{
	... when != ptr.next = NULL;
	    when != ptr.kernel_data = NULL;
(
*	copy_to_user@p((T)param, ptr, sizeof(*ptr))
|
*	COPYOUT@p(*ptr)
)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2014-1738')
