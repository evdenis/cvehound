/// Files: net/netfilter/nft_set_pipapo.c
/// Fix: 87b5a5c209405cb6b57424cdfa226a6dbd349232
/// Fixes: 3c4287f62044a90e73a561aa05fc46e62da173da

virtual detect

@err@
identifier match_start, match_end, data, e;
type T;
position p;
@@

nft_pipapo_remove(...)
{
	...
*	match_start =@p data;
*	match_end = (T *)nft_set_ext_key_end(&e->ext)->data;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-4004')
