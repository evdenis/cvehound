/// Files: drivers/md/dm-verity-target.c
/// Fix: 4caae58406f8ceb741603eee460d79bacca9b1b5
/// Fixes: a4ffc152198efba2ed9e6eac0eb97f17bfebce85
/// Version: 1.0.7

virtual detect

@fix@
symbol verity_target;
@@

struct target_type verity_target = {
	...,
	.features = DM_TARGET_IMMUTABLE | ...,
	...
};

@err depends on !fix@
symbol verity_target;
position p;
@@

struct target_type verity_target =@p {
	...
};

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-20572')
