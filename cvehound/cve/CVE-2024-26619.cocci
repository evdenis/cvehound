/// Files: arch/riscv/kernel/module.c
/// Fix: 78996eee79ebdfe8b6f0e54cb6dcc792d5129291
/// Fixes: d8792a5734b0f3e58b898c2e2f910bfac48e9ee3

virtual detect

@err@
identifier bucket, entry, rel_head;
position p;
@@

add_relocation_to_accumulate(...)
{
	...
	if (!bucket) {
		kfree(entry);
*		kfree@p(rel_head);
*		kfree(rel_head->rel_entry);
 		return -ENOMEM;
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26619')
