/// Files: drivers/accel/habanalabs/common/habanalabs_ioctl.c
/// Fix: a9f07790a4b2250f0140e9a61c7f842fd9b618c7
/// Fixes: 0c88760f8f5e13e32f624a1da71144b240b05125

virtual detect

@err@
identifier info, sec_attest_info;
position p;
@@

sec_attest_info(...)
{
	...
	sec_attest_info = kmalloc(sizeof(*sec_attest_info), GFP_KERNEL);
	if (!sec_attest_info)
		return -ENOMEM;
	...
*	info = kmalloc@p(sizeof(*info), GFP_KERNEL);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-50431')
