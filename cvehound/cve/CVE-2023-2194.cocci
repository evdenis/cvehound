/// Files: drivers/i2c/busses/i2c-xgene-slimpro.c
/// Fix: 92fbb6d1296f81f41f65effd7f5f8c0f74943d15
/// Fixes: f6505fbabc426b9e293da5bb702ace2eb1ccf87d

virtual detect

@err@
identifier ctx, writelen, data;
position p;
@@

slimpro_i2c_blkwr(struct slimpro_i2c_dev *ctx, ..., u32 writelen, void *data)
{
	... when != if (writelen > I2C_SMBUS_BLOCK_MAX) return -EINVAL;
*	memcpy@p(ctx->dma_buffer, data, writelen);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-2194')
