/// Files: fs/ksmbd/auth.c
/// Fix: 797805d81baa814f76cf7bdab35f86408a79d707
/// Fixes: e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9

virtual detect

@err@
identifier authblob, nt_len, domain_name;
position p;
@@

ksmbd_decode_ntlmssp_auth_blob(struct authenticate_message *authblob, ...)
{
	...
*	nt_len =@p le16_to_cpu(authblob->NtChallengeResponse.Length);
	... when != if (...|| nt_len < CIFS_ENCPWD_SIZE) return -EINVAL;
*	domain_name = smb_strndup_from_utf16(...);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-0210')
