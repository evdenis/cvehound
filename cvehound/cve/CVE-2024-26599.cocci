/// Files: drivers/pwm/core.c
/// Fix: a297d07b9a1e4fb8cda25a4a2363a507d294b7c9
/// Fixes: 3ab7b6ac5d829e60c3b89d415811ff1c9f358c8e

virtual detect

@err@
identifier args, pwm;
position p;
@@

of_pwm_single_xlate(..., const struct of_phandle_args *args)
{
	...
*	if (args->args_count == 2 && args->args[2]@p & PWM_POLARITY_INVERTED)
*		pwm->args.polarity = PWM_POLARITY_INVERSED;
	
	return pwm;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26599')
