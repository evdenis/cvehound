/// Files: drivers/gpu/drm/msm/msm_gem_submit.c
/// Fix: d839f0811a31322c087a859c2b181e2383daa7be
/// Fixes: 20224d715a882210428ea62bba93f1bc4a0afe23

virtual detect

@err@
identifier sz, ret;
expression E;
position p;
@@

submit_lookup_cmds(...)
{
	...
*	E = kmalloc(sz, GFP_KERNEL);
	... when != if (!E) { ret = -ENOMEM; goto out; }
*	copy_from_user@p(E, ..., sz)
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-3355')
