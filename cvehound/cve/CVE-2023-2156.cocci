/// Files: net/ipv6/rpl.c
/// Fix: 4e006c7a6dac0ead4c1bf606000aa90a372fc253
/// Fixes: 8610c7c6e3bd647ff98d21c8bc0580e77bc2f8b3
/// Version: 1.1.0

virtual detect

@err@
identifier n, cmpri, cmpre;
position p;
@@

ipv6_rpl_srh_size(unsigned char n, unsigned char cmpri,
		  unsigned char cmpre)
{
*	return (n * IPV6_PFXTAIL_LEN(cmpri)) + IPV6_PFXTAIL_LEN(cmpre)@p;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-2156')
