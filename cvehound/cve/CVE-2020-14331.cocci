/// Files: drivers/video/console/vgacon.c
/// Fix: ebfdfeeae8c01fcb2b3b74ffaf03876e20835d2d
/// Fixes: 15bdab959c9bb909c0317480dd9b35748a8f7887

virtual detect

@err@
identifier c, t, count;
position p;
@@

vgacon_scrollback_update(struct vc_data *c, int t, int count)
{
	...
	while (count--) {
		... when != if ((\(vgacon_scrollback_cur->tail\|vgacon_scrollback_tail\) + c->vc_size_row) > \(vgacon_scrollback_cur->size\|vgacon_scrollback_size\)) \(vgacon_scrollback_cur->tail\|vgacon_scrollback_tail\) = 0;
*		scr_memcpyw@p(...);
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], "ERROR: CVE-2020-14331")
