/// Files: drivers/gpu/drm/amd/display/dc/resource/dcn301/dcn301_resource.c drivers/gpu/drm/amd/display/dc/dcn301/dcn301_resource.c
/// Fix: 58fca355ad37dcb5f785d9095db5f748b79c5dc2
/// Fixes: 3a83e4e64bb1522ddac67ffc787d1c38291e1a65

virtual detect

@err@
identifier enc1, vpg, afmt;
position p;
@@

struct stream_encoder *dcn301_stream_encoder_create(...)
{
	...
*	if (!enc1 || !vpg || !afmt)@p {
(
		kfree(enc1);
		kfree(vpg);
		kfree(afmt);
		return NULL;
|
		return NULL;
)
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26660')
