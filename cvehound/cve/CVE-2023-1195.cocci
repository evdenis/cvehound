/// Files: fs/cifs/connect.c
/// Fix: 153695d36ead0ccc4d0256953c751cabf673e621
/// Fixes: 7be3248f313930ff3d3436d4e9ddbe9fccc1f541

virtual detect

@err@
identifier server;
position p;
@@

cifs_put_tcp_session(struct TCP_Server_Info *server, ...)
{
	...
*	kfree@p(server->hostname);
	... when != server->hostname = NULL;
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-1195')
