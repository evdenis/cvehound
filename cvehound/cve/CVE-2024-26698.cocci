/// Files: drivers/net/hyperv/netvsc.c
/// Fix: e0526ec5360a48ad3ab2e26e802b0532302a7e11
/// Fixes: ac5047671758ad4be9f93898247b3a8b6dfde4c7

virtual detect

@err@
identifier net_device, i;
position p;
@@

netvsc_device_remove(...)
{
	...
*	for (i = 0; i < net_device->num_chn; i++) {
*		napi_disable@p(&net_device->chan_table[i].napi);
*		netif_napi_del(&net_device->chan_table[i].napi);
*	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26698')
