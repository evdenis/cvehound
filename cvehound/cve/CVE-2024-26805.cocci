/// Files: net/netlink/af_netlink.c
/// Fix: 661779e1fcafe1b74b3f3fe8e980c1e207fea1fd
/// Fixes: 1853c949646005b5959c483becde86608f548f24

virtual detect

@err@
identifier skb, len;
position p;
@@

netlink_to_full_skb(const struct sk_buff *skb, ...)
{
*	unsigned int len = skb_end_offset@p(skb);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26805')
