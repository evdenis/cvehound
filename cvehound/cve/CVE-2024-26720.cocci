/// Files: mm/page-writeback.c
/// Fix: 9319b647902cbd5cc884ac08a8a6d54ce111fc78
/// Detect-To: 5a53748568f79641eaf40e41081a2f4987f005c2

virtual detect

@limit@
identifier dirty;
@@

node_dirty_limit(...)
{
	...
	return min_t(unsigned long, dirty, UINT_MAX);
}

@err depends on !limit@
identifier dtc, bdi_thresh, background_thresh, dirty_thresh; 
position p;
typedef u64;
@@

\(wb_dirty_limits\|bdi_dirty_limits\)(...)
{
	...
(
*	div_u64@p((u64)dtc->wb_thresh * dtc->bg_thresh, dtc->thresh)
|
*	div_u64@p((u64)*bdi_thresh * background_thresh, dirty_thresh)
)
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26720')
