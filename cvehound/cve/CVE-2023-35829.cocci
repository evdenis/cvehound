/// Files: drivers/staging/media/rkvdec/rkvdec.c
/// Fix: 3228cec23b8b29215e18090c6ba635840190993d
/// Fixes: cd33c830448baf7b1e94da72eca069e3e1d050c9

virtual detect

@err@
identifier pdev, rkvdec;
position p;
@@

rkvdec_remove(struct platform_device *pdev)
{
*	struct rkvdec_dev *rkvdec = platform_get_drvdata(pdev);
	... when != cancel_delayed_work_sync(&rkvdec->watchdog_work);
*	rkvdec_v4l2_cleanup@p(rkvdec);
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-35829')
