/// Files: drivers/atm/idt77252.c
/// Fix: 3f4093e2bf4673f218c0bf17d8362337c400e77b
/// Fixes: v2.6.12-rc2

virtual detect

@err@
symbol idt77252_chain;
identifier card;
position p;
@@

idt77252_exit(void)
{
	...
	while (idt77252_chain) {
		... when != del_timer_sync(&card->tst_timer);
		    when != timer_shutdown_sync(&card->tst_timer);
*		deinit_card@p(card);
		...
	}
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2022-3635')
