/// Files: net/netrom/af_netrom.c
/// Fix: 611792920925fb088ddccbe2783c7f92fdfb6b64
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier sock, sk;
statement S;
position p;
@@

nr_listen(struct socket *sock, ...)
{
	...
*	lock_sock@p(sk);
	... when != if (sock->state != SS_UNCONNECTED) { release_sock(sk); return -EINVAL; }
	if (sk->sk_state != TCP_LISTEN)
		S
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-32269')
