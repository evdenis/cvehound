/// Files: fs/btrfs/volumes.c
/// Fix: 9ea0106a7a3d8116860712e3f17cd52ce99f6707
/// Fixes: faa775c41d655a4786e9d53cb075a77bb5a75f66

virtual detect

@err@
identifier fs_info, ret;
position p;
@@

btrfs_get_dev_args_from_path(struct btrfs_fs_info *fs_info, ...)
{
	...
* 	ret = btrfs_get_bdev_and_sb(..., FMODE_READ, fs_info->bdev_holder, ...);
*	if (ret@p)
*		return ret;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-4394')
