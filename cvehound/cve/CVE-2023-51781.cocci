/// Files: net/appletalk/ddp.c
/// Fix: 189ff16722ee36ced4d2a2469d4ab65a8fee4198
/// Fixes: v2.6.12-rc2

virtual detect

@err@
identifier sk;
symbol amount, skb;
position p;
@@

atalk_ioctl(...)
{
	...
*	struct sk_buff *skb =@p skb_peek(&sk->sk_receive_queue);
*	long amount = 0;
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-51781')
