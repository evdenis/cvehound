/// Files: drivers/scsi/ufs/ufs-mediatek.c drivers/ufs/host/ufs-mediatek.c
/// Fix: 3ba880a12df5aa4488c18281701b5b1bc3d4531a
/// Fixes: cf137b3ea49a04e0c843b12674afa4b1d23e827f

virtual detect

@err@
identifier hba;
statement S1, S2;
expression E;
position p;
@@

ufs_mtk_init_va09_pwr_ctrl(struct ufs_hba *hba)
{
	...
*	E = regulator_get(hba->dev, "va09");
*	if (!E@p)
		S1
	else
		S2
	...
}

@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2023-23001')
