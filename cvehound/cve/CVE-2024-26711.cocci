/// Files: drivers/iio/adc/ad4130.c
/// Fix: a22b0a2be69a36511cb5b37d948b651ddf7debf3
/// Fixes: 62094060cf3acaf52e277457d807ea753269b89e

virtual detect

@fix@
symbol init;
position p;
@@

ad4130_setup_int_clk(struct ad4130_state *st)
{
	...
	struct clk_init_data init = {};
	...
}

@err depends on !fix@
symbol init;
position p;
@@

ad4130_setup_int_clk(struct ad4130_state *st)
{
	...
	struct clk_init_data init;@p
	...
}


@script:python depends on detect@
p << err.p;
@@

coccilib.report.print_report(p[0], 'ERROR: CVE-2024-26711')
